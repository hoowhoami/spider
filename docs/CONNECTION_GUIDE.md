# 工作流编辑器 - 节点连线指南

## 如何连接节点

### 基本操作

1. **添加节点**
   - 从左侧面板拖拽节点到画布
   - 例如：拖拽一个 "URL Input" 节点和一个 "AI Extract" 节点

2. **连接节点**

   **方法 A：从输出到输入**

   ```
   步骤：
   1. 将鼠标移到第一个节点底部的小圆点（输出点）
   2. 按住鼠标左键
   3. 拖拽到第二个节点顶部的小圆点（输入点）
   4. 释放鼠标
   ```

   **方法 B：从输入到输出**

   ```
   步骤：
   1. 将鼠标移到第二个节点顶部的小圆点（输入点）
   2. 按住鼠标左键
   3. 拖拽到第一个节点底部的小圆点（输出点）
   4. 释放鼠标
   ```

3. **删除连接**
   ```
   步骤：
   1. 点击连接线（会变成选中状态）
   2. 按 Delete 或 Backspace 键
   ```

### 连接点说明

每个节点有两个连接点：

```
        ⬤  ← 输入点（顶部）
    ┌─────────┐
    │  节点   │
    └─────────┘
        ⬤  ← 输出点（底部）
```

- **输入点（顶部圆点）**：接收来自上游节点的数据
- **输出点（底部圆点）**：发送数据到下游节点

### 连接规则

1. **数据流向**：数据从上到下流动

   ```
   [节点 A]
      ↓
   [节点 B]
      ↓
   [节点 C]
   ```

2. **多输入**：一个节点可以接收多个输入

   ```
   [节点 A] ↘
             → [节点 C]
   [节点 B] ↗
   ```

3. **多输出**：一个节点可以连接到多个下游节点

   ```
           ↗ [节点 B]
   [节点 A]
           ↘ [节点 C]
   ```

4. **不能循环**：不能创建循环连接
   ```
   ❌ 错误：
   [节点 A] → [节点 B] → [节点 A]  (循环)
   ```

### 视觉提示

- **灰色圆点**：未连接的 Handle
- **高亮圆点**：鼠标悬停时
- **蓝色连接线**：已建立的连接
- **虚线预览**：拖拽时的连接预览

### 常见问题

**Q: 为什么无法连接两个节点？**
A: 确保从输出点（底部）拖拽到输入点（顶部），或反向操作。

**Q: 如何创建分支？**
A: 从一个节点的输出点拖拽到多个节点的输入点。

**Q: 如何合并数据流？**
A: 从多个节点的输出点拖拽到同一个节点的输入点。

**Q: 连接线可以自定义样式吗？**
A: 当前使用默认样式，未来可以添加自定义样式选项。

### 实际示例

**示例 1：线性流程**

```
[URL Input]
    ↓
[AI Extract]
    ↓
[Output]
```

操作：

1. 添加三个节点
2. 从 URL Input 底部拖拽到 AI Extract 顶部
3. 从 AI Extract 底部拖拽到 Output 顶部

**示例 2：并行处理**

```
[URL Input]
    ↓
[Batch Crawl]
    ↓
[AI Extract] → [AI Analyze] → [Output]
```

操作：

1. 先创建主链路
2. 从 AI Extract 底部拖拽到 AI Analyze 顶部
3. 从 AI Analyze 底部拖拽到 Output 顶部

**示例 3：多源合并**

```
[URL Input 1] ↘
                → [AI Extract] → [Output]
[URL Input 2] ↗
```

操作：

1. 添加两个 URL Input 节点和一个 AI Extract 节点
2. 从 URL Input 1 底部拖拽到 AI Extract 顶部
3. 从 URL Input 2 底部拖拽到 AI Extract 顶部

### 键盘快捷键

- **Delete/Backspace**：删除选中的连接或节点
- **Ctrl/Cmd + Z**：撤销（React Flow 内置）
- **Ctrl/Cmd + Shift + Z**：重做（React Flow 内置）

### 技术细节

连接功能由 React Flow 库提供：

- 自动处理连接验证
- 自动计算连接线路径
- 支持贝塞尔曲线连接线
- 内置拖拽和交互逻辑

### 下一步

创建好连接后：

1. 点击节点配置参数
2. 点击 "Execute" 执行工作流
3. 查看执行结果
